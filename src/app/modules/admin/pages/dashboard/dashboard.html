<div class="admin-banner">
  <div class="banner-content">
    <h1>PANEL DE ADMINISTRACI√ìN</h1>
    <p>GESTI√ìN DE PROGRAMADORES Y DISPONIBILIDAD</p>
  </div>
</div>

<div class="admin-canvas">
  <div class="admin-card">
    <!-- MENU -->
    <div class="menu-admin">
      <button (click)="vista = 'crear'" [class.activo]="vista === 'crear'">
        ‚ûï Crear Programador
      </button>

      <button (click)="vista = 'lista'" [class.activo]="vista === 'lista'">üìã Programadores</button>

      <button (click)="mostrarDashboard()" [class.activo]="vista === 'dashboard'">
        üìä DASHBOARD
      </button>

      <button (click)="vista = 'horarios'" [class.activo]="vista === 'horarios'">
        üïí Horarios
      </button>
    </div>

    <!-- CREAR -->
    <div *ngIf="vista === 'crear'" class="seccion">
      <h2>Registrar Nuevo Programador</h2>

      <form (ngSubmit)="crearProgramador()">
        <label>Nombre completo</label>
        <input type="text" [(ngModel)]="nuevoProgramador.name" name="name" required />

        <label>Correo</label>
        <input type="email" [(ngModel)]="nuevoProgramador.email" name="email" required />

        <label>Especialidad</label>
        <input type="text" [(ngModel)]="nuevoProgramador.specialty" name="specialty" required />

        <button class="btn-primary" type="submit">Crear Programador</button>
      </form>
    </div>

    <!-- LISTA -->
    <div *ngIf="vista === 'lista'" class="seccion">
      <h2>Programadores Registrados</h2>

      <div *ngFor="let p of programadores" class="tarjeta">
        <h3>{{ p.nombre }}</h3>
        <p><strong>Email:</strong> {{ p.email }}</p>
        <p><strong>Especialidad:</strong> {{ p.especialidad || 'Sin especialidad' }}</p>

        <div class="acciones">
          <button class="btn-editar" (click)="editarProgramador(p)">Editar</button>
          <button class="btn-eliminar" (click)="eliminarProgramador(p.id)">Eliminar</button>
        </div>
      </div>
    </div>

    <!-- EDITAR -->
    <div *ngIf="vista === 'editar'" class="seccion">
      <h2>Editar Programador</h2>

      <form (ngSubmit)="actualizarProgramador()">
        <label>Nombre</label>
        <input type="text" [(ngModel)]="programadorEditando.nombre" name="editNombre" required />

        <label>Correo</label>
        <input type="email" [(ngModel)]="programadorEditando.email" name="editEmail" required />

        <label>Especialidad</label>
        <input
          type="text"
          [(ngModel)]="programadorEditando.especialidad"
          name="editEspecialidad"
          required
        />

        <button class="btn-primary" type="submit">Guardar Cambios</button>
        <button class="btn-secundario" type="button" (click)="vista = 'lista'">Cancelar</button>
      </form>
    </div>

    <!-- Seccion Dashboard -->
    <div *ngIf="vista === 'dashboard'" class="seccion dashboard">
      <!-- Header -->
      <div class="dashboard-header">
        <h2 class="titulo">Dashboard de Asesor√≠as</h2>

        <!-- BOT√ìN PDF -->
        <button class="btn-pdf" (click)="exportarAsesoriasPDF()">üìÑ Descargar reporte PDF</button>
        <button class="btn-pdf secondary" (click)="exportarProyectosPDF()">üìÅ Proyectos PDF</button>
      </div>

      <!-- KPIs -->
      <div class="kpi-container">
        <div class="kpi-card">
          <h3>Total de asesor√≠as</h3>
          <p class="numero">{{ totalAsesorias }}</p>
        </div>
      </div>

      <!-- Gr√°ficos -->
      <div class="dashboard-grid">
        <div class="chart-box">
          <h3>Asesor√≠as por programador</h3>
          <canvas id="chartProgramadores"></canvas>
        </div>

        <div class="chart-box small">
          <h3>Estado de asesor√≠as</h3>
          <canvas id="chartEstado"></canvas>
        </div>
      </div>

      <!-- Lista -->
      <div class="lista-stats">
        <h3>Detalle por programador</h3>
        <ul>
          <li *ngFor="let p of statsProgramador">
            {{ p[0] }}: <strong>{{ p[1] }}</strong>
          </li>
        </ul>
      </div>
    </div>

    <!-- HORARIOS -->
    <div *ngIf="vista === 'horarios'" class="seccion">
      <h2>Horarios de Disponibilidad</h2>

      <label>Seleccionar Programador</label>
      <select [(ngModel)]="programadorSeleccionado" (change)="cambiarProgramador()" class="select">
        <option [ngValue]="null">-- Seleccionar programador --</option>
        <option *ngFor="let p of programadores" [ngValue]="p">
          {{ p.nombre }}
        </option>
      </select>

      <div *ngIf="programadorSeleccionado" class="horarios">
        <h3>Horario de {{ programadorSeleccionado.nombre }}</h3>

        <label>D√≠a</label>
        <select [(ngModel)]="nuevoHorario.dia" name="dia">
          <option>Lunes</option>
          <option>Martes</option>
          <option>Mi√©rcoles</option>
          <option>Jueves</option>
          <option>Viernes</option>
          <option>S√°bado</option>
        </select>

        <div class="grid-2">
          <div>
            <label>Hora Inicio</label>
            <input type="time" [(ngModel)]="nuevoHorario.horaInicio" name="inicio" />
          </div>

          <div>
            <label>Hora Fin</label>
            <input type="time" [(ngModel)]="nuevoHorario.horaFin" name="fin" />
          </div>
        </div>

        <button class="btn-primary" (click)="guardarHorario()">Agregar horario</button>

        <h3>Horarios Registrados</h3>
        <ul class="lista-horarios">
          <li *ngFor="let h of horariosProgramador">
            {{ h.dia }} ‚Äî {{ h.horaInicio }} a {{ h.horaFin }}

            <div class="acciones">
              <button class="btn-editar" (click)="editarHorario(h)">Editar</button>
              <button class="btn-eliminar" (click)="eliminarHorarioConfirmado(h.id)">
                Eliminar
              </button>
            </div>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- MODAL MENSAJE -->
<div class="overlay" *ngIf="mostrarModalMensaje">
  <div class="confirm-modal animate">
    <h2>Notificaci√≥n</h2>
    <p>{{ mensajeModal }}</p>
    <button class="close-btn" (click)="mostrarModalMensaje = false">Cerrar</button>
  </div>
</div>

<!-- MODAL CONFIRMACI√ìN -->
<div class="overlay" *ngIf="mostrarModalConfirmacion">
  <div class="confirm-modal animate">
    <h2>‚ö† Confirmaci√≥n</h2>
    <p>{{ mensajeModal }}</p>

    <div class="btn-row">
      <button class="close-btn cancel" (click)="cancelarAccion()">Cancelar</button>
      <button class="close-btn confirm" (click)="confirmarAccion()">S√≠, continuar</button>
    </div>
  </div>
</div>
